{% extends "main_layout.html" %}

{% block head %}
    <link href="../static/index_style.css" rel="stylesheet">
{% endblock head %}

{% block title %}
    Flights
{% endblock title %}

{% block content %}

    <div class="div_top">
        <img class="ico_top" src="../static/airplane_icon.png">
        <p class="par_top">Flight Details</p>
        <div class="div_head">
            <p class="head_date">Date</p>
            <p class="head_time">Departure/Arrival</p>
            <p class="head_dest">Destination</p>
        </div>
    </div>   

    <form method="POST">
        <div class="div_flig">
            <select class="sel_flig" name="sel_flig" id="select_flig" onchange="changeSeat(this)">
                <option value="0">
                    <p>Select available flights here</p>
                </option>
                {% for f in flight_list %}
                <option value="{{f[0]}}">
                    <p>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;{{f[1]}}</p>
                    <p>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;{{f[2]}}</p>
                    <p>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;{{f[3]}}</p>
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="div_buy">
            <p class="par_buy">Buy Ticket</p>
            <select class="sel_seat" name="sel_seat" id="select_seat" onchange="changeInfo(this)">
                <option value="0">
                    <p>Select available seats here</p>
                </option>
            </select>
            <div class="div_pass">
                <p class="par_pass">Enter password to confirm:</p>
                <input class="txt_pass" type="password" name="txt_pass" id="txt_pass">
                <img src="../static/eyeslash.png" id="btn_pass"> 
                <button class="btn_buy" type="submit">Buy Ticket</button>
            </div>   
        </div>
    </form>    

    <div class="div_info">
        <p class="par_type">Seat Type:</p>
        <input class="txt_type" type="text" id="type_seat" readonly>
        <p class="par_pric">Seat Price:</p>
        <input class="txt_pric" type="text" id="price_seat" readonly>
    </div>
    
    <div class="div_seat">
        <p class="par_view">Seats View</p>
        <div class="box_free"></div>
        <p class="par_free">Free</p>
        <div class="box_occu"></div>
        <p class="par_occu">Occupied</p>
    </div>

    <div>
        <p class="del_seat">Deluxe Seats</p>
        <p class="fir_clas">First Class</p>
        <p class="eco_clas">Economy Class</p>
    </div>

    <div id="GROUPS">
        <div id="GROUP1">
            <div id="A1">A1</div><div id="A2">A2</div><div id="A3">A3</div>
            <div id="B1">B1</div><div id="B2">B2</div><div id="B3">B3</div>
        </div>
        <div id="GROUP2">
            <div id="C1">C1</div><div id="C2">C2</div><div id="C3">C3</div>
            <div id="D1">D1</div><div id="D2">D2</div><div id="D3">D3</div>
        </div>
        <div id="GROUP3">
            <div id="A4">A4</div><div id="A5">A5</div><div id="A6">A6</div><div id="A7">A7</div><div id="A8">A8</div>
            <div id="B4">B4</div><div id="B5">B5</div><div id="B6">B6</div><div id="B7">B7</div><div id="B8">B8</div>
            <div id="C4">C4</div><div id="C5">C5</div><div id="C6">C6</div><div id="C7">C7</div><div id="C8">C8</div>
        </div>
        <div id="GROUP4">
            <div id="D4">D4</div><div id="D5">D5</div><div id="D6">D6</div><div id="D7">D7</div><div id="D8">D8</div>
            <div id="E4">E4</div><div id="E5">E5</div><div id="E6">E6</div><div id="E7">E7</div><div id="E8">E8</div>
            <div id="F4">F4</div><div id="F5">F5</div><div id="F6">F6</div><div id="F7">F7</div><div id="F8">F8</div>
        </div>
        <div id="GROUP5">
            <div id="A9">A9</div><div id="A10">A10</div><div id="A11">A11</div><div id="A12">A12</div><div id="A13">A13</div>
            <div id="A14">A14</div><div id="A15">A15</div> <div id="A16">A16</div><div id="A17">A17</div><div id="A18">A18</div>
            <div id="B9">B9</div><div id="B10">B10</div><div id="B11">B11</div><div id="B12">B12</div><div id="B13">B13</div>
            <div id="B14">B14</div><div id="B15">B15</div><div id="B16">B16</div><div id="B17">B17</div><div id="B18">B18</div>
            <div id="C9">C9</div><div id="C10">C10</div><div id="C11">C11</div><div id="C12">C12</div><div id="C13">C13</div>
            <div id="C14">C14</div><div id="C15">C15</div><div id="C16">C16</div><div id="C17">C17</div><div id="C18">C18</div>
            <div id="D9">D9</div><div id="D10">D10</div><div id="D11">D11</div><div id="D12">D12</div><div id="D13">D13</div>
            <div id="D14">D14</div><div id="D15">D15</div><div id="D16">D16</div><div id="D17">D17</div><div id="D18">D18</div>
        </div>
        <div id="GROUP6">
            <div id="E9">E9</div><div id="E10">E10</div><div id="E11">E11</div><div id="E12">E12</div><div id="E13">E13</div>
            <div id="E14">E14</div><div id="E15">E15</div><div id="E16">E16</div><div id="E17">E17</div><div id="E18">E18</div>
            <div id="F9">F9</div><div id="F10">F10</div><div id="F11">F11</div><div id="F12">F12</div> <div id="F13">F13</div>
            <div id="F14">F14</div><div id="F15">F15</div><div id="F16">F16</div><div id="F17">F17</div><div id="F18">F18</div>
            <div id="G9">G9</div><div id="G10">G10</div><div id="G11">G11</div><div id="G12">G12</div><div id="G13">F13</div>
            <div id="G14">G14</div><div id="G15">G15</div><div id="G16">G16</div><div id="G17">G17</div><div id="G18">G18</div>
            <div id="H9">H9</div><div id="H10">H10</div><div id="H11">H11</div><div id="H12">H12</div><div id="H13">H13</div>
            <div id="H14">H14</div><div id="H15">H15</div><div id="H16">H16</div><div id="H17">H17</div><div id="H18">H18</div>
        </div>
    </div>

    <script>
        
        var seatlist = ["A1", "A2","A3","A4","A5","A6","A7","A8","A9","A10","A11","A12","A13","A14","A15","A16","A17","A18",
                        "B1", "B2","B3","B4","B5","B6","B7","B8","B9","B10","B11","B12","B13","B14","B15","B16","B17","B18",
                        "C1", "C2","C3","C4","C5","C6","C7","C8","C9","C10","C11","C12","C13","C14","C15","C16","C17","C18",
                        "D1", "D2","D3","D4","D5","D6","D7","D8","D9","D10","D11","D12","D13","D14","D15","D16","D17","D18",
                        "E4","E5","E6","E7","E8","E9","E10","E11","E12","E13","E14","E15","E16","E17","E18",
                        "F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","F16","F17","F18",
                        "G9","G10","G11","G12","G13","G14","G15","G16","G17","G18",
                        "H9","H10","H11","H12","H13","H14","H15","H16","H17","H18",
        ];

        var seats = JSON.parse('{{flight_seat|tojson|safe}}');
        
        var select_flight = document.getElementById('select_flig');
        var select_seat = document.getElementById('select_seat');
        var type_seat = document.getElementById('type_seat');
        var price_seat = document.getElementById('price_seat');
        
        function changeSeat(f){
            flight = f.options[f.selectedIndex].value;
            
            select_seat.length = 1;
            type_seat.value = "";
            price_seat.value = "";
            
            for(ctr = 0; ctr < seats.length; ctr++){
                if(String(flight) == String(seats[ctr][0]) && String(seats[ctr][4]) == "free"){
                    opt = document.createElement('option');
                    opt.value = String(seats[ctr][1]);
                    opt.innerHTML = String(seats[ctr][2]) + " - " + String(seats[ctr][1]);
                    select_seat.appendChild(opt);
                }
            }

            for(ctr = 0; ctr < seatlist.length; ctr++){
                seat = document.getElementById(String(seatlist[ctr]));
                seat.style.backgroundColor = "#dadada";
            }

            for(ctr = 0; ctr < seats.length; ctr++){
                if(String(flight) == String(seats[ctr][0]) && String(seats[ctr][4]) != "free"){
                    seat = document.getElementById(String(seats[ctr][1]));
                    seat.style.backgroundColor = "#004aad";
                }
            }
        }

        function changeInfo(s){
            seat = s.options[s.selectedIndex].value;
            flight = select_flight.options[select_flight.selectedIndex].value;

            for(ctr = 0; ctr < seats.length; ctr++){
                if(String(flight) == String(seats[ctr][0]) && String(seat) == String(seats[ctr][1])){
                    type_seat.value = seats[ctr][2];
                    price_seat.value = "Php " + seats[ctr][3];
                }
            }

            if(String(seat) == "0"){
                type_seat.value = "";
                price_seat.value = "";
            }
        }

        function removeDivFlash(){
            var div = document.getElementById('div_flash');
            var btn = document.getElementById('btn_flash');

            div.remove();
            btn.remove();
        }

        var btn_pass = document.querySelector("#btn_pass");
        var txt_pass = document.querySelector("#txt_pass");

        btn_pass.addEventListener("click", function(){
            type = txt_pass.getAttribute("type") == "password" ? "text" : "password";
            txt_pass.setAttribute("type", type);

            link = btn_pass.getAttribute("src");
            if(link == "../static/eyeslash.png"){
                btn_pass.setAttribute("src", "../static/eye.png");
            }
            else{
                btn_pass.setAttribute("src", "../static/eyeslash.png");
            }
        });

    </script>

{% endblock content %}